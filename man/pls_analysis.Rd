% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pls_analysis.R
\name{pls_analysis}
\alias{pls_analysis}
\title{Partial Least Squares Analysis}
\usage{
pls_analysis(datamat_lst, num_subj_lst, num_cond, option = NULL)
}
\arguments{
\item{datamat_lst}{List of data matrices, one per group. Each matrix should
have subjects in rows (organized by condition) and variables in columns.}

\item{num_subj_lst}{Vector of number of subjects per group. Can also be a
list of vectors for split-subject-blocks.}

\item{num_cond}{Number of conditions.}

\item{option}{Optional list of analysis parameters:
\describe{
  \item{method}{PLS method (1-6, default 1):
    \itemize{
      \item 1 = Mean-Centering Task PLS
      \item 2 = Non-Rotated Task PLS
      \item 3 = Regular Behavior PLS
      \item 4 = Multiblock PLS
      \item 5 = Non-Rotated Behavior PLS
      \item 6 = Non-Rotated Multiblock PLS
    }}
  \item{num_perm}{Number of permutations (default 0)}
  \item{num_boot}{Number of bootstrap samples (default 0)}
  \item{num_split}{Number of split-half iterations (default 0)}
  \item{clim}{Confidence level 0-100 (default 95)}
  \item{bscan}{Subset of conditions for behavior block in multiblock PLS}
  \item{stacked_designdata}{Design contrast matrix for non-rotated PLS}
  \item{stacked_behavdata}{Stacked behavioral data for behavior PLS}
  \item{meancentering_type}{Mean-centering type 0-3 (default 0)}
  \item{cormode}{Correlation mode: 0=Pearson, 2=covariance, 4=cosine, 6=dot product}
  \item{boot_type}{"strat" (default) or "nonstrat" bootstrap}
  \item{verbose}{Print progress messages (default TRUE)}
  \item{robust_method}{Robust correlation method: "none", "spearman", "winsorized", "biweight", "percentage_bend"}
  \item{robust_trim}{Trim proportion for winsorized correlation (default 0.1)}
  \item{robust_beta}{Bend constant for percentage bend (default 0.2)}
}}
}
\value{
A list with class "pls_result" containing:
\describe{
  \item{method}{PLS method used}
  \item{u}{Brain latent variable (salience)}
  \item{s}{Singular values}
  \item{v}{Design/Behavior latent variable}
  \item{usc}{Brain scores}
  \item{vsc}{Design/Behavior scores}
  \item{lvcorrs}{LV correlations (behavior PLS only)}
  \item{datamatcorrs_lst}{Correlation maps (behavior PLS only)}
  \item{perm_result}{Permutation test results (if num_perm > 0)}
  \item{boot_result}{Bootstrap results (if num_boot > 0)}
}
}
\description{
Run PLS analysis on one or more data matrices with optional permutation
testing and bootstrap resampling for statistical inference.
}
\examples{
\dontrun{
# Task PLS with 2 groups, 3 conditions
datamat1 <- matrix(rnorm(30 * 100), nrow = 30, ncol = 100)
datamat2 <- matrix(rnorm(30 * 100), nrow = 30, ncol = 100)

result <- pls_analysis(
  datamat_lst = list(datamat1, datamat2),
  num_subj_lst = c(10, 10),
  num_cond = 3,
  option = list(method = 1, num_perm = 500, num_boot = 500)
)

# Behavior PLS with robust correlation
result <- pls_analysis(
  datamat_lst = list(brain_data),
  num_subj_lst = c(20),
  num_cond = 2,
  option = list(
    method = 3,
    stacked_behavdata = behavior_data,
    robust_method = "biweight"
  )
)
}
}
\seealso{
\code{\link{pls_summary_table}}, \code{\link{plot_lv_summary}}
}
